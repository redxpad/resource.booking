# Бронирование ресурсов

Для доступа к REST API Bitrix24 запросите у интегратора вебхук, или создайте его самостоятельно на своем портале в разделе Разработчикам-> Другое-> Входящий вебхук. Если создаете вебхук самостоятельно выберите методы к которым у вебхука будет доступ. Для создания/изменения сделок и получения информации о бронировании потребуются права на доступ к методам crm и calendar.

Полученный вебхук добавляем в файл settings.php в 'C_REST_WEB_HOOK_URL'.

Для вызова методов Rest API Bitrix24 можно использовать метод "call" класса CRest описанный в файле crest.php. Метод принимает в качестве первого аргумента строку - название вызываемого метода, например 'crm.deal.update', а вторым аргументом набор параметров описанных в документации.

## Доступные ресурсы на портале

Чтобы узнать идентификаторы доступных ресурсов нужно использовать метод [calendar.resource.list](https://dev.1c-bitrix.ru/rest_help/calendar/calendar_resource_list.php), метод вызывается без параметров и возвращает список ресурсов с названиями и идентификаторами.
Пример кода в файле getResourcesExample.php

## Информация о бронированиях

Чтобы получить информацию о текущих бронированиях используем метод [calendar.resource.booking.list](https://dev.1c-bitrix.ru/rest_help/calendar/calendar_resource_booking_list.php) с фильтром (параметр filter) по одному или нескольким идентификаторам ресурсов и временому диапазону.
Пример кода в файле getBookingExample.php

## Бронирование в сделке

Создать бронирование в сделке можно при создании [crm.deal.add](https://dev.1c-bitrix.ru/rest_help/crm/cdeals/crm_deal_add.php) или изменении [crm.deal.update](https://dev.1c-bitrix.ru/rest_help/crm/cdeals/crm_deal_update.php) сделки. Информацию о бронировании необходимо передавать в пользовательское поле, если вы не знаете идентификатор поля - уточните его у интегратора, информация о бронировании передается строкой формата "resource|25|20.03.2020 15:00:00|3600|Примерка", где resource - тип бронирования, 25 - идентификатор ресурса, 20.03.2020 15:00:00 - дата и время бронирования, 3600 - длительность бронирования в секундах, Примерка - название бронирования.
Пример кода для создания бронирования при изменении сделки в файле addBookingExample.php
